%% LyX 2.0.6 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.
\documentclass[brazil,landscape, lettersize]{article}
\usepackage[T1]{fontenc}
\usepackage[utf8]{luainputenc}
\usepackage[dvips]{geometry}
\geometry{verbose,lmargin=3cm,rmargin=3cm}

\makeatletter
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User specified LaTeX commands.
\usepackage[dvips]{geometry} 
\usepackage[brazil]{babel}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{epsfig}
%\usepackage[pdftex,hyperfigures]{hyperref}

\usepackage[lined,boxed,commentsnumbered]{algorithm2e}

\textheight 17.29cm
\textwidth 22.94cm 

\oddsidemargin -0.6mm
\evensidemargin -0.6mm

\topmargin -1.5cm

\makeatother


\begin{document}

\title{TRIEDA - Documenta√ß√£o da Heur√≠stica}


\author{Autor: Gapso}

\maketitle

\section{Introdu√ß√£o}

Este documento foi escrito com o √¢mbito de documentar simbolicamente
o framework e o funcionamento da heur√≠stica construtiva usada na ferramenta
TRIEDA. 

Na sec√ß√£o \ref{sec:Par=0000E2metros-Gerais} s√£o introduzidos alguns
dos par√¢metros gerais que condicionam o funcionamento da heur√≠stica
e s√£o necess√°rios para descrever os seus algoritmos mais relevantes.
Estes par√¢metros gerias s√£o identificados ao longo do documento com
o sobrescrito {*}. Os algoritmos principais da heur√≠stica s√£o introduzidos
na sec√ß√£o \ref{sec:Algoritmos-Principais}, sendo apresentado para
cada um o seu objectivo, o pseudo-c√≥digo, os principais sub-m√©todos
usados e o arquivo onde se encontra implementado o c√≥digo. Os MIPs
usados pela heur√≠stica s√£o descritos nas sec√ß√µes \ref{sec:MIP-Realocar-Alunos}
e \ref{sec:MIP-Alocar-Professores}, onde s√£o apresentados os m√©todos
de pr√© e p√≥s-processamento da solu√ß√£o e toda a estrutura do modelo,
assim como a sua localiza√ß√£o no c√≥digo.


\section{Par√¢metros Gerais\label{sec:Par=0000E2metros-Gerais}}

Nesta sec√ß√£o s√£o apresentados alguns par√¢metros gerais da heur√≠stica
que podem ser fixados internamente (pr√©-compila√ß√£o) ou atrav√©s de
argumentos opcionais inseridos aquando da execu√ß√£o do programa.
\begin{itemize}
\item \emph{versaoFast}: Determina se o algoritmo terminar√° sem o uso de
MIPs para realoca√ß√£o de alunos e professores. A aloca√ß√£o de professores
desta solu√ß√£o pode n√£o ser v√°lida.
\item \emph{limMinAlunos}: Limite m√≠nimo de alunos que √© usado em alguns
casos especiais.
\item \emph{mipRealocSalas}: Determina se o MIP de realoca√ß√£o de alunos
tamb√©m realoca as salas das turmas.
\item \emph{heurRealocAlunos}: Determina se nas fases de constru√ß√£o heur√≠sticas
s√£o usados os mecanismos de realoca√ß√£o de alunos.
\item \emph{relaxMinAlunos}: Relaxamento no minimo de alunos usado na fase
de abertura de turmas legais.
\item \emph{profsVirtuaisIndiv}: Determina se o algoritmo deve criar professores
virtuais individualizados.
\item \emph{minRecCred}: M√≠nimo imposto no MIP de aloca√ß√£o de alunos sobre
a raz√£o $\frac{cr\acute{e}ditos\, alunos}{cr\acute{e}ditos\, professores}$.
\item \emph{desvioMax}: Desvio percentual m√°ximo usado para a escolha das
turmas potenciais candidatas a ser abertas.
\item \emph{relacPraticas}: Rela√ß√£o imposta entre turmas te√≥ricas e pr√°ticas:
$M \times N$, $1 \times N$ ou $1 \times 1$
\item \emph{percChAnt}: Percentagem da carga hor√°ria do semestre anterior
que se deve tentar atender para cada professor.
\item \emph{minChForte}: Determina se a restri√ß√£o de m√≠nimo de carga hor√°ria
de um professor deve ser forte.
\item \emph{fecharTurmasCarregadas} : Indica se √© permitido fechar turmas
carregadas de uma solu√ß√£o.
\end{itemize}

\section{Algoritmos Principais\label{sec:Algoritmos-Principais}}

Nesta sec√ß√£o s√£o descritos os m√©todos chave usados pela heur√≠stica.
A apresenta√ß√£o de cada um deles come√ßa com uma introdu√ß√£o ao prop√≥sito
do algoritmo, seguida de uma breve descri√ß√£o dos sub-m√©todos e dos
seus par√¢metros, sendo o pseudo-c√≥digo exibido e analisado no final.
Os arquivos a consultar no c√≥digo do projecto s√£o identificado no
final da sub-sec√ß√£o.


\subsection{Develop Solu√ß√£o\label{sub:Develop-Solu=0000E7=0000E3o}}


\paragraph*{Objetivo}

O prop√≥sito do m√©todo \emph{Develop Solu√ß√£o }√© construir e melhorar
uma solu√ß√£o a partir de um estado inicial. Esta solu√ß√£o tanto pode
n√£o ter nenhuma aloca√ß√£o como conter j√° algumas aloca√ß√µes definidas.


\paragraph*{Sub-m√©todos}
\begin{itemize}
\item \emph{abrirTurmas} \emph{(bool equiv, bool usarVirtual, bool realoc,
bool formAnySize, int priorAluno = 0, double relaxMin = 1.0)}. Este
m√©todo tenta abrir turmas na solu√ß√£o atual com base nas demandas n√£o
atendidas de prioridade 1, alocando alunos, salas e professores a
estas. Uma turma pode ser aberta com um professor virtual, mas em
nenhuma circunst√¢ncia pode ser aberta sem ter uma sala dispon√≠vel.
Os par√¢metros deste m√©todo t√™m o seguinte impacto:

\begin{itemize}
\item \emph{equiv} : determina se a aloca√ß√£o de demandas equivalentes √©
ou n√£o usada.
\item \emph{usarVirtual} : determina se √© possivel abrir uma turma sem professor
real.
\item \emph{realoc} : determina se os mecanismos de realoca√ß√£o de alunos
s√£o usados ao longo da abertura de turmas. Estes mecanismos procuram
atender mais demandas ao realocar alunos entre turmas.
\item \emph{formAnySize} : determina se √© permitido abrir uma turma com
formando de qualquer tamanho (considerando que √© poss√≠vel violar o
m√≠nimo). Se o valor do par√¢metro for \emph{false}, o m√≠nimo de alunos
para abrir uma turma com formando √© definido pelo par√¢metro \emph{limMinAlunos{*}}.
\item \emph{priorAluno} : define a prioridade m√°xima de aluno que pode ser
atendida. Caso este valor for zero, qualquer aluno pode ser atendido.
\emph{Default: 0}.
\item \emph{relaxMin} : determina o grau de relaxamento que √© dado ao m√≠nimo
de alunos turma. O valor m√≠nimo de alunos turma considerado para a
abertura das turmas ser√° calculado pela express√£o $\left\lceil relaxMin\cdot min\right\rceil $,
onde \emph{min} √© o par√¢metro pre-estabelecido para o m√≠nimo de alunos
requerido para a turma em quest√£o. \emph{Default: 1.0}.
\end{itemize}
\item \emph{tryAlocPDois} \emph{(int priorAluno = 0)}. Este m√©todo tenta
alocar heuristicamente demandas n√£o atendidas de prioridade 2 em turmas
j√° abertas.

\begin{itemize}
\item \emph{priorAluno} : define a prioridade m√°xima de aluno que pode ser
atendida. Caso este valor for zero, qualquer aluno pode ser atendido.
\emph{Default: 0}.
\end{itemize}
\item \emph{realocarAlunosMIP} \emph{(Solucao solucaoInicial, bool realocSalas,
int minRecCred, int priorAluno = 0, bool alocarP2 = true)}. Este m√©todo
resolve um MIP que realoca os alunos √†s turmas abertas e decide que
turmas devem ser fechadas, procurando maximizar a demanda atendida.
Pode ou n√£o permitir a realoca√ß√£o das turmas para novas salas da mesma
unidade da sala atual.

\begin{itemize}
\item \emph{solucaoInicial} : solu√ß√£o inicial que √© carregada no MIP.
\item \emph{realocSalas} : determina se √© permitida ou n√£o a realoca√ß√£o
de salas dentro da mesma unidade.
\item \emph{minRecCred }: m√≠nimo imposto atrav√©s do MIP para a rela√ß√£o $\frac{cr\acute{e}ditos\, alunos}{cr\acute{e}ditos\, professores}$.
\item \emph{priorAluno} : define a prioridade m√°xima de aluno que pode ser
atendida. Caso este valor for zero, qualquer aluno pode ser atendido.
Quando este valor √© maior que zero, todos os alunos de maior prioridade
s√£o fixados nas suas turmas atuais, e estas s√£o obrigadas a ser abertas.
\emph{Default: 0}.
\item \emph{alocarP2} : determina se o MIP deve tentar alocar demandas de
prioridade 2 ou n√£o. \emph{Default: true}.
\end{itemize}
\item \emph{realocarProfsMIP(bool profsVirtuaisIndiv). }Este m√©todo realoca
os professores √†s turmas atrav√©s da resolu√ß√£o de um modelo MIP, tentando
minimizar o n√∫mero de turmas com professor virtual e o n√∫mero de professores
virtuais individualizados necess√°rios, assim como a sua respetiva
titula√ß√£o e tipo de contrato.

\begin{itemize}
\item \emph{profsVirtuaisIndiv }: determina se devem ser criados professores
virtuais individualizados para atender turmas √†s quais n√£o seja poss√≠vel
alocar um professor real. Se o par√¢metro for \emph{false}, todas as
turmas com professor virtual ser√£o alocadas a um 'professor virtual
√∫nico' que √© nada mais que uma etiqueta mostrando que n√£o foi possivel
encontrar professor real para essas turmas. Se o par√¢metro for \emph{true},
a estimativa de professores virtuais necess√°rios vai ser baseada no
n√∫mero de turmas com professor virtual \emph{a priori}.
\end{itemize}
\end{itemize}

\paragraph*{Pseudo-c√≥digo}

Fazendo refer√™ncia aos sub-m√©todos apresentados, √© possivel definir
o pseudo-c√≥digo do m√©todo \emph{Develop Solu√ß√£o, }apresentado no Algoritmo
\ref{algo_develop}\emph{.}

\IncMargin{1em}
\LinesNumbered
\begin{algorithm}[H]
	\SetKwComment{Comment}{\textbackslash\textbackslash}{}
	\SetKwFunction{abrirTurmas}{abrirTurmas} \SetKwFunction{tryAlocPDois}{tryAlocPDois}
	\SetKwFunction{realocarAlunosMIP}{realocarAlunosMIP} \SetKwFunction{realocarProfsMIP}{realocarProfsMIP}
	\SetKwData{solucaoLegal}{solucaoLegal}\SetKwData{this}{this}
	\abrirTurmas{$true, true, heurRealocAlunos^{*}, false$}\label{abrirUm}\;
	\If{$versaoFast^{*}$}{\label{fast}
		\tryAlocPDois{}\;
		\Return{}\; \label{endFast}
	}
	\solucaoLegal $\leftarrow$ \this\label{guardar}\;
	\abrirTurmas{$true, true, heurRealocAlunos^{*}, true, 0, relaxMinAlunos^{*}$}\label{ilegal}\;
	\realocarAlunosMIP{\solucaoLegal, $mipRealocSalas^{*}, minRecCred^{*}$}\label{mipAlunos}\;
	\abrirTurmas($true, true, false, true$)\label{posMip}\;
	\If{novas turmas depois do MIP}{
		\tryAlocPDois{}\label{maisPdois}\;
	}
	\realocarProfsMIP{$false$}\label{mipProfUm}\;
	\If{$profsVirtuaisIndiv^{*}$}{
		\realocarProfsMIP{$true$}\label{mipProfDois}\;
	}
	\caption{Algoritmo Develop Solu√ß√£o}\label{algo_develop}
\end{algorithm}
\DecMargin{1em}\medskip{}


O primeiro passo no desenvolvimento da solu√ß√£o e abrir turmas legais
{[}linha \ref{abrirUm}{]}, i.e. que respeitem o m√≠nimo de alunos.
A utiliza√ß√£o de m√©todos heur√≠sticos de realoca√ß√£o de alunos durante
a abertura de turmas √© determinada pelo par√¢metro geral $heurRealocAlunos^{*}$.
Depois desta fase a solu√ß√£o encontra-se num estado v√°lido. Caso o
par√¢metro geral $versaoFast^{*}$ estiver ativo, o m√©todo termina
{[}linha \ref{fast}-\ref{endFast}{]}. Caso contr√°rio, o estado atual
da solu√ß√£o √© guardado para ser usado posteriormente como solu√ß√£o inicial
do MIP de realoca√ß√£o de alunos e fechamento de turmas {[}linhas \ref{guardar}{]}.
Na fase seguinte s√£o abertas mais turmas, relaxando o m√≠nimo de alunos
obrigat√≥rio {[}linha \ref{ilegal}{]}. 

Tendo em conta todas as turmas abertas naquele momento, legais e ilegais,
o MIP realoca os alunos e fecha as turmas inv√°lidas, tendo por objectivo
maximizar a demanda atendida, respeitando as diversas restri√ß√µes associadas
ao problema {[}linha \ref{mipAlunos}{]}. Depois do MIP a solu√ß√£o
est√° num estado v√°lido e √© feita uma √∫ltima tentativa de abrir turmas
legais, sem recursos aos m√©todos de realoca√ß√£o e permitindo a abertura
de turmas de formandos com qualquer tamanho {[}linha \ref{posMip}{]}.
Se for aberta alguma turma nesta fase, √© chamado o m√©todo \emph{tryAlocPDois}
para tentar alocar mais demandas de prioridade 2 heuristicamente {[}linha
\ref{maisPdois}{]}. 

Por fim √© feita a aloca√ß√£o de professores. Quando mencionamos o estado
v√°lido de uma solu√ß√£o, isto n√£o diz respeito a algumas restri√ß√µes
que possam estar a ser violadas na aloca√ß√£o de professores, nomeadamente
as restri√ß√µes que imp√µem m√≠nimos, como as restri√ß√µes de m√≠nimo de
mestres e doutores por curso, m√≠nimo de horas por dia alocado, etc.
Para que aloca√ß√£o de professores fique de acordo com os regulamentos
impostos, √© necess√°rio realoc√°-los usando o modelo MIP. Primeiro √©
feita uma realoca√ß√£o sem professores virtuais individuais, na qual
√© considerada que uma turma com professor virtual contribui para o
m√≠nimo de mestres e doutores do curso {[}linha \ref{mipProfUm}{]}.
Caso o par√¢metro $profsVirtuaisIndiv^{*}$ esteja ligado, s√£o criados
professores virtuais individualizados {[}linha \ref{mipProfDois}{]}.


\paragraph*{C√≥digo}

A implementa√ß√£o do m√©todo \emph{Develop Solu√ß√£o }encontra-se na classe
\emph{SolucaoHeur}, definida nos arquivos \emph{'SolucaoHeur.h' }e\emph{
'SolucaoHeur.cpp'} do projeto. O m√©todo √© \emph{SolucaoHeur::developSolucao}.


\subsection{Abrir Turmas}

Nesta sec√ß√£o ser√° analisado um pouco mais a fundo o m√©todo \emph{abrirTurmas
}introduzido na sec√ß√£o \ref{sub:Develop-Solu=0000E7=0000E3o}, onde
tamb√©m foram apresentados os seus par√¢metros e devido impacto.


\paragraph*{Objectivo}

Este m√©todo tenta abrir turmas na solu√ß√£o atual com base nas demandas
n√£o atendidas de prioridade 1, alocando alunos, salas e professores
a estas. Uma turma pode ser aberta com um professor virtual, mas em
nenhuma circunst√¢ncia pode ser aberta sem ter uma sala dispon√≠vel.


\paragraph*{Sub-m√©todos}
\begin{itemize}
\item \emph{abrirTurmasOfertaDisciplina (OfertaDisciplina oferta)} : Este
m√©todo tenta abrir novas turmas para uma oferta-disciplina, que representa
um par campus-disciplina. Quando √© chamado, tenta abrir uma turma
da componente principal da disciplina (te√≥rica, ou pr√°tica se for
100\% pr√°tica) ao analisar todas as combina√ß√µes de hor√°rios possiveis,
e escolhendo uma de entre as melhores turmas potenciais caso ela exista.
√â sempre dada prioridade a turmas potenciais que tenham um professor
real dispon√≠vel (tipo 0). Caso n√£o haja nenhuma √© escolhida uma turma
potencial com professor virtual que esteja aberta em hor√°rios que
constam das disponibilidades de professores reais (tipo 1). Finalmente,
caso n√£o houver uma turma do tipo 0 ou 1, √© escolhida uma das restantes
turmas. A turma a abrir √© seleccionada randomicamente de entre as
que t√™m um desvio m√°ximo $desvioMax^{*}$ relativamente √† melhor turma
daquele tipo. Nenhuma turma √© aberta sem sala dispon√≠vel, e a escolha
da sala procura maximizar o n√∫mero de alunos em primeiro lugar e a
ocupa√ß√£o da sala em segundo.\linebreak{}
Se a disciplina em quest√£o s√≥ tiver uma componente, este m√©todo s√≥
abre uma turma e retorna. Caso tenha dois componentes, comporta-se
de diferentes maneiras dependendo da rela√ß√£o entre turmas te√≥ricas
e pr√°ticas impostas. Se a rela√ß√£o for NxN, o m√©todo vai tentar abrir
todas as turmas te√≥ricas que conseguir com as demandas n√£o atendidas.
Depois, tentar√° abrir turmas pr√°ticas para alocar estes alunos. Se
a rela√ß√£o for 1xN o m√©todo so abrir√° uma turma te√≥rica antes de tentar
abrir as pr√°ticas. Se a rela√ß√£o for 1x1 s√≥ uma te√≥rica e uma pr√°tica
ser√£o abertas. No final s√£o sempre removidos da oferta-disciplina
os alunos que n√£o foram alocados √†s duas componentes. Este m√©todo
retorna um booleano que informa se alguma turma foi aberta ou n√£o.
\item \emph{getOfertasDisciplinaOrdenadas} : Com base nas demandas n√£o atendidas
e no comparador vigente retorna as ofertas-disciplina ordenadas.
\item \emph{reordenarOfertasDisciplina (set<OfertaDisciplina> ofertasDisciplina)}:
Com base nas demandas n√£o atendidas e no comparador vigente reordena
um conjunto de ofertas-disciplina.
\end{itemize}

\paragraph*{Pseudo-c√≥digo}

Fazendo refer√™ncia aos sub-m√©todo apresentados, √© possivel definir
o pseudo-c√≥digo do m√©todo \emph{Abrir Turmas}, apresentado no Algoritmo
\ref{algo_abrir}\emph{.}

\IncMargin{1em}
\LinesNumbered
\begin{algorithm}[H]
	\SetKwComment{Comment}{\textbackslash\textbackslash}{}
	\SetKwInOut{Input}{input}\SetKwInOut{Param}{par√¢metros}
	\SetKwFunction{size}{size}\SetKwFunction{first}{first}
	\SetKwFunction{remove}{remove}\SetKwFunction{insert}{insert}
	\SetKwFunction{abrirOftDisc}{abrirTurmasOfertaDisciplina} 
	\SetKwFunction{getOfts}{getOfertasDisciplinaOrdenadas}
	\SetKwFunction{reordOfts}{reordenarOfertasDisciplina} 
	\SetKwData{equiv}{equiv}\SetKwData{usarVirtual}{usarVirtual}\SetKwData{realoc}{realoc}
	\SetKwData{formAnySize}{formAnySize}\SetKwData{priorAluno}{priorAluno}\SetKwData{relaxMin}{relaxMin}
	\SetKwData{ofertasOrd}{ofertasOrd}\SetKwData{oferta}{oferta}
	\SetKwData{abriu}{abriu}\SetKwData{relacPrat}{relacPraticas*}

	\Param{\equiv, \usarVirtual, \realoc, \formAnySize, \priorAluno, \relaxMin}
	\BlankLine
	\ofertasOrd $\leftarrow$ \getOfts{}\label{getOrd}\;
	\While{\ofertasOrd.\size{} > 0}{
		\oferta $\leftarrow$ \ofertasOrd.\first{}\;
		\ofertasOrd.\remove{\oferta}\;
		\abriu $\leftarrow$ \abrirOftDisc{\oferta}\;
		\If{$\abriu$ {\bf and} $\relacPrat \neq M \times N$ }{
			\ofertasOrd.\insert{\oferta}\;
			\reordOfts{\ofertasOrd}\;
		}
	}
	\caption{Algoritmo Abrir Turmas}\label{algo_abrir}
\end{algorithm}
\DecMargin{1em}\medskip{}


O m√©todo de abertura de turmas come√ßa por obter uma lista ordenada
das ofertas-disciplina. Depois entra num ciclo em que vai tentando
abrir turmas para as ofertas-disciplina por ordem. Caso seja aberta
uma turma para uma oferta-disciplina, e a rela√ß√£o entre te√≥ricas e
pr√°ticas n√£o for \emph{NxN}, ela √© re-inserida na lista, que √© reordenada.
Quando a lista de ofertas-disciplina estiver vazia o m√©todo retorna.


\paragraph*{C√≥digo}

A implementa√ß√£o do m√©todo\emph{ Abrir Turmas} encontra-se repartida
entre as classes \emph{SolucaoHeur} e \emph{AbridorTurmas}, definidas
nos arquivos \emph{'SolucaoHeur.h'},\emph{ 'SolucaoHeur.cpp', 'AbridorTurmas.h'
}e\emph{ 'AbridorTurmas.cpp'} do projeto. Os m√©todos chave s√£o \emph{SolucaoHeur::abrirTurmas}
e \emph{AbridorTurmas::abrirTurmas}.


\subsection{Improve Solu√ß√£o}


\paragraph*{Objetivo}

O prop√≥sito do m√©todo \emph{Improve Solu√ß√£o }√© construir e melhorar
uma solu√ß√£o carregada. Este m√©todo pr√©-processa uma solu√ß√£o carregada
antes de chamar o m√©todo \emph{Develop Solu√ß√£o}, que a expande.


\paragraph*{Sub-m√©todos}
\begin{itemize}
\item \emph{removerAlunosIncompletos (bool carregados) }: Remove alunos
que s√≥ estejam alocados em uma de duas componentes, se $relacPratica\neq M\times N$.

\begin{itemize}
\item \emph{carregados} : caso uma solu√ß√£o inicial tenha sido carregada,
e a heur√≠stica esteja tentando melhorar essa solu√ß√£o, determina se
as aloca√ß√µes de alunos iniciais devem ser removidas ou n√£o.
\end{itemize}
\item \emph{fecharTurmasVazias }: Fecha turmas que tenham sido carregadas
sem alunos.
\item \emph{tryReduzirSalas }: Tenta trocar as salas das turmas de forma
a maximizar a ocupa√ß√£o das salas, e libertar salas maior. As trocas
s√≥ s√£o permitidas em turmas da mesma unidade.
\item \emph{tryAlocNaoAtendidos (bool mudarSalas, bool equiv, bool realoc,
int priorAluno) }: Tenta alocar novos alunos √†s turmas j√° abertas.

\begin{itemize}
\item \emph{mudarSalas }: indica se √© permitido trocar a sala de uma turma
dentro da mesma unidade.
\item \emph{equiv} : determina se a aloca√ß√£o de demandas equivalentes √©
ou n√£o usada.
\item \emph{realoc}: determina se os mecanismos de realoca√ß√£o de alunos
s√£o usados. Estes mecanismos procuram atender mais demandas ao realocar
alunos entre turmas.
\item \emph{priorAluno}: define a prioridade m√°xima de aluno que pode ser
atendida. Caso este valor for zero, qualquer aluno pode ser atendido.
\end{itemize}
\item \emph{acertarSolucao (bool carregados, double relaxMin = 1.0) }: Remove
alunos com aloca√ß√µes incompletas e fecha turmas deficitarias.

\begin{itemize}
\item \emph{carregados }: caso uma solu√ß√£o inicial tenha sido carregada,
e a heur√≠stica esteja tentando melhorar essa solu√ß√£o, determina se
as aloca√ß√µes de alunos iniciais devem ser removidas ou n√£o.
\item \emph{relaxMin }: determina o grau de relaxamento que √© dado ao m√≠nimo
de alunos turma. O valor m√≠nimo de alunos turma considerado para a
abertura das turmas ser√° calculado pela express√£o $\left\lceil relaxMin\cdot min\right\rceil $,
onde \emph{min} √© o par√¢metro pre-estabelecido para o m√≠nimo de alunos
requerido para a turma em quest√£o. \emph{Default: 1.0}.
\end{itemize}
\item \emph{developSolucao }: m√©todo \emph{Develop Solu√ß√£o} descrito na
sec√ß√£o \ref{sub:Develop-Solu=0000E7=0000E3o}.
\item \emph{logMudancas} : escrever log de sugest√µes de mudan√ßas.
\end{itemize}

\paragraph*{Pseudo-c√≥digo}

Fazendo refer√™ncia aos sub-m√©todo apresentados, √© possivel definir
o pseudo-c√≥digo do m√©todo \emph{Improve Solu√ß√£o, }apresentado no Algoritmo
\ref{algo_improve}\emph{.}

\IncMargin{1em}
\LinesNumbered
\begin{algorithm}[H]
	\SetKwComment{Comment}{\textbackslash\textbackslash}{}
	\SetKwFunction{remvInc}{removerAlunosIncompletos} 
	\SetKwFunction{fechVaz}{fecharTurmasVazias}
	\SetKwFunction{redSalas}{tryReduzirSalas}
	\SetKwFunction{alocNA}{tryAlocNaoAtendidos} 
	\SetKwFunction{acertar}{acertarSolucao} 
	\SetKwFunction{develop}{developSolucao} 
	\SetKwFunction{log}{logMudancas} 
	\SetKwData{fechPar}{fecharTurmasCarregadas*}
	\SetKwData{realPar}{heurRealocAlunos*}
	\SetKwData{relacPrat}{relacPraticas*}

	\If{$\relacPrat \neq M \times N$}{
		\remvInc{$true$}\label{l_removInc}\;
	}
	\fechVaz{}\label{l_fechar}\;
	\redSalas{}\label{l_salas}\;
	\alocNA{$true, true, \realPar, 0$}\label{l_alocNa}\;
	\If{$\fechPar$}{
		\acertar{$true$}\label{l_acertar}\;
	}
	\develop{}\label{l_develop}\;
	\log{}\label{l_log}\;
	\caption{Algoritmo Improve Solu√ß√£o}\label{algo_improve}
\end{algorithm}
\DecMargin{1em}\medskip{}


O primeiro passo executado, caso a rela√ß√£o entre te√≥ricas e pr√°ticas
seja diferente de $M \times N$, consiste em remover os alunos que
n√£o estejam alocados completamente a uma disciplina {[}linha \ref{l_removInc}{]}.
Em seguida, caso haja turmas vazias estas s√£o fechadas {[}linha \ref{l_fechar}{]}.
Depois h√° uma tentativa de mudar as salas das turmas de forma a maximizar
a ocupa√ß√£o das salas, e libertar salas maiores {[}linha \ref{l_salas}{]}.
O quarto passo √© tentar alocar os alunos n√£o atendidos nas turmas
carregadas, permitindo a mudan√ßa de sala das mesmas, dentro da mesma
unidade {[}linha \ref{l_alocNa}{]}. Se for permitido fechar turmas
carregadas, a solu√ß√£o √© acertada, fechando turmas deficit√°rias e removendo
alunos incompletos at√© estar num estado v√°lido {[}linha \ref{l_acertar}{]}.
O algoritmo \emph{Develop Solu√ß√£o} √© ent√£o chamado para abrir mais
turmas e tentar atender a demanda n√£o atendida e melhorar a solu√ß√£o
{[}linha \ref{l_develop}{]}. Por fim, √© gerado um log com as sugest√µes
de mudan√ßas {[}linha \ref{l_log}{]}.


\section{MIP Realocar Alunos\label{sec:MIP-Realocar-Alunos}}

Nesta sec√ß√£o ser√° apresentado o MIP por detr√°s da fun√ß√£o \emph{realocarAlunosMIP
}introduzido na sec√ß√£o \ref{sub:Develop-Solu=0000E7=0000E3o}, onde
tamb√©m foram apresentados os seus par√¢metros e devido impacto.


\paragraph*{Objectivo}

Realocar os alunos √†s turmas abertas e decidir que turmas devem ser
fechadas, procurando maximizar a demanda atendida. Pode ou n√£o permitir
a realoca√ß√£o das turmas para novas salas da mesma unidade da sala
atual.


\paragraph*{Pr√©-processamento}
\begin{itemize}
\item \emph{removerAlunosTurmas (int priorAluno, bool carregados) }: Remove
os alunos das turmas.

\begin{itemize}
\item \emph{priorAluno} : determina a prioridade de alunos que deve ser
removida. S√≥ ser√£o removidos alunos com o valor prioridade igual ou
superior a \emph{priorAluno}.
\item \emph{carregados} : caso uma solu√ß√£o inicial tenha sido carregada,
e a heur√≠stica esteja tentando melhorar essa solu√ß√£o, determina se
as aloca√ß√µes de alunos iniciais devem ser removidas ou n√£o.
\end{itemize}
\end{itemize}

\subsection{Nota√ß√£o}


\subsubsection{Conjuntos}
\begin{itemize}
\item \emph{A} - conjunto de alunos. Os elementos desse conjunto s√£o denotados
por \emph{a}.
\item $D_{a}$ - conjunto de demandas n√£o atendidas de um aluno. Os elementos
desse conjunto s√£o denotados por \emph{d}.
\item \emph{O} - conjunto de ofertas-disciplina. Os elementos desse conjunto
s√£o denotados por \emph{o}.
\item \emph{T} - conjunto de turmas. Os elementos desse conjunto s√£o denotados
por \emph{t}.
\item $S$ - conjunto de salas. Os elementos desse conjunto s√£o denotados
por \emph{s}.
\item $A_{t}$ - conjunto de alunos dispon√≠veis para ser alocados a uma
turma \emph{t}. Os elementos desse conjunto s√£o denotados por \emph{a}.
\item $O^{2}$ - conjunto de ofertas-disciplina com duas componentes. Os
elementos desse conjunto s√£o denotados por \emph{o}.
\item $O_{a}$ - conjunto de ofertas-disciplina que um aluno \emph{a} pode
cursar. Os elementos desse conjunto s√£o denotados por \emph{o}.
\item $O_{a}^{2}$ - conjunto de ofertas-disciplina com 2 componentes que
um aluno \emph{a} pode cursar. Os elementos desse conjunto s√£o denotados
por \emph{o}.
\item $O_{a,p}$ - conjunto de ofertas-disciplina que um aluno \emph{a}
pode cursar, associadas demandas com prioridade \emph{p}. Os elementos
desse conjunto s√£o denotados por \emph{o}.
\item $O_{a,d}$ - conjunto de ofertas-disciplina que podem atender uma
demanda n√£o atendida \emph{d} de um aluno \emph{a}. Os elementos desse
conjunto s√£o denotados por \emph{o}.
\item $C_{o}$ - conjunto de componentes de uma oferta \emph{o}. Os elementos
desse conjunto s√£o denotados por \emph{c}.
\item $T_{o,c}$ - conjunto de turmas de uma componente \emph{c} de uma
oferta-disciplina \emph{o}. Os elementos desse conjunto s√£o denotados
por \emph{t}.
\item $T_{a}$ - conjunto de turmas a que o aluno \emph{a} pode ser alocado.
Os elementos desse conjunto s√£o denotados por \emph{t}.
\item $TA$ - conjunto de turmas que t√™m que ser mantidas abertas. Os elementos
desse conjunto s√£o denotados por \emph{t}.
\item $CTI_{a}$ - conjunto de conjuntos turmas que um aluno \emph{a} pode
cursar e que s√£o todas incompat√≠veis entre si. Os elementos desse
conjunto s√£o denotados por \emph{TI}.
\item $CTI_{s}$ - conjunto de conjuntos turmas que uma sala \emph{s} pode
acolher e que s√£o todas incompat√≠veis entre si. Os elementos desse
conjunto s√£o denotados por \emph{TI}.
\item $S_{t}$ - conjunto de salas dispon√≠veis para acolher uma turma \emph{t}.
Os elementos desse conjunto s√£o denotados por \emph{s}.
\end{itemize}

\subsubsection{Dados do Modelo}
\begin{itemize}
\item $creds\left(o\right)$ - total de cr√©ditos de uma oferta-disciplina
\emph{o}.
\item $creds\left(t\right)$ - n√∫mero de cr√©ditos de uma turma \emph{t}.
\item $maxCreds\left(a\right)$ - m√°ximo de creditos que um aluno \emph{a}
pode cursar.
\item $demsP1\left(a\right)$ - n√∫mero de demandas P1 n√£o atendidas de um
aluno \emph{a}.
\item $demsP2\left(a\right)$ - n√∫mero de demandas P2 n√£o atendidas de um
aluno \emph{a}.
\item $minAlunos\left(t\right)$ - m√≠nimo de alunos imposto para abrir uma
turma \emph{t}.
\item $coefMin\left(a,t\right)$ - coeficiente com que o aluno \emph{a}
contribui para o m√≠nimo de alunos da turma \emph{t}. Se o aluno for
formando e o m√≠nimo poder ser violado, este valor √© $minAlunos\left(t\right)$.
Caso contrario √© 1.
\item $maxAlunos\left(t,s\right)$ - m√°ximo de alunos que a turma \emph{t}
pode acolher se for alocada √† sala \emph{s}.
\item $\alpha\left(a,o\right)$ - peso da vari√°vel $x_{a,o}$ na fun√ß√£o
objetivo.
\item $\beta\left(t\right)$ - peso da vari√°vel $at_{t}$ na fun√ß√£o objetivo.
\end{itemize}

\subsubsection{Vari√°veis}
\begin{itemize}
\item $x_{a,o}$ - vari√°vel bin√°ria indicando que o aluno \emph{a} foi alocado
√† oferta-disciplina \emph{o}.
\item $y_{a,t}$ - vari√°vel bin√°ria indicando que o aluno \emph{a} foi alocado
√† turma \emph{t}.
\item $at_{t}$ - vari√°vel bin√°ria indicando se uma turma \emph{t} foi aberta
ou n√£o.
\item $w_{t,t'}$- vari√°vel bin√°ria indicando que a turma te√≥rica \emph{t
}foi associada √† turma pr√°tica \emph{t' }da mesma oferta-disciplina\emph{.
}S√≥ usadas se $relacPraticas^{*}\neq M\times N$.
\item $r_{t,s}$ - vari√°vel bin√°ria indicando que uma turma \emph{t} foi
alocada a uma sala \emph{s}.
\end{itemize}

\subsection{Formula√ß√£o}


\subsubsection{Fun√ß√£o Objetivo
\[
MAX\:\sum_{a\in A}\sum_{o\in O_{a}}\alpha\left(a,o\right)\cdot x_{a,o}+\sum_{t\in T}\beta\left(t\right)
\]
}


\subsubsection{M√°ximo de cr√©ditos por aluno
\[
\sum_{o\in O_{a}}x_{a,o}\cdot creds\left(o\right)\leq maxCreds\left(a\right)\qquad\forall a\in A
\]
}


\subsubsection{N√£o atender demandas P2 se tiver atendido todas de P1
\[
\sum_{o\in O_{a,1}}x_{a,o}\cdot demsP2\left(a\right)+\sum_{o\in O_{a,2}}x_{a,o}\leq demsP1\left(a\right)\cdot demsP2\left(a\right)\qquad\forall a\in A
\]
}


\subsubsection{Atender disciplina original ou uma das equivalentes
\[
\sum_{o\in O_{a,d}}x_{a,o}\leq1\qquad\forall a\in A\:\forall d\in D_{a}
\]
}


\subsubsection{Impedir a aloca√ß√£o de alunos a turmas incompativeis
\[
\sum_{t\in TI}y_{a,t}\leq1\qquad\forall a\in A\:\forall TI\in CTI_{a}
\]
}


\subsubsection{Alocar o aluno a uma oferta-disciplina na totalidade
\[
\sum_{t\in T_{o,c}}y_{a,t}=x_{a,o}\qquad\forall a\in A\:\forall o\in O_{a}\:\forall c\in C_{o}
\]
}


\subsubsection{Impede um aluno de ser alocado duas turmas da mesma oferta-disciplina
se elas n√£o estiverem associadas (s√≥ se $relacPraticas^{*}\neq M\times N$)
\[
y_{a,t}+y_{a,t'}\leq w_{t,t'}+1\qquad\forall a\in A\,\forall o\in O_{a}\:\forall t\in T_{o,teorico}\:\forall t'\in T_{o,pratico}
\]
}


\subsubsection{Impedir um aluno de ser alocado a uma turma te√≥rica de uma disciplina
com duas componentes, quando esta n√£o √© associada a uma pr√°tica (s√≥
se $relacPraticas^{*}\neq M\times N$)
\[
y_{a,t}\leq\sum_{t'\in T_{o,pratico}}w_{t,t'}\qquad\forall a\in A\,\forall o\in O_{a}^{2}\:\forall t\in T_{o,teorico}
\]
}


\subsubsection{Alocar cada turma a uma sala
\[
\sum_{s\in S_{t}}r_{t,s}=at_{t}\qquad\forall t\in T
\]
}


\subsubsection{M√≠nimo de alunos por turma
\[
\sum_{a\in A_{t}}y_{a,t}\cdot coefMin\left(a,t\right)\geq minAlunos\left(t\right)\cdot at_{t}\qquad\forall t\in T
\]
}


\subsubsection{M√°ximo de alunos por turma
\[
\sum_{a\in A_{t}}y_{a,t}\leq\sum_{s\in S_{t}}maxAlunos\left(t,s\right)\cdot r_{t,s}\qquad\forall t\in T
\]
}


\subsubsection{Relacionar vari√°vel de aloca√ß√£o aluno-turma com vari√°vel de abertura
de turma
\[
y_{a,t}\leq at_{t}\qquad\forall a\in A\,\forall t\in T{}_{a}
\]
}


\subsubsection{Obrigar uma turma pr√°tica a s√≥ se associar com uma turma te√≥rica
da oferta-disciplina (s√≥ se $relacPraticas^{*}\neq M\times N$)
\[
\sum_{t^{'}\in T_{o,teorico}}w_{t',t}=at_{t}\qquad\forall o\in O^{2}\,\forall t\in T_{o,pratico}
\]
}


\subsubsection{Obrigar uma turma te√≥rica a associar-se a pelo menos uma turma pr√°tica
da oferta-disciplina (s√≥ se $relacPraticas^{*}=1\times N$ e turma
te√≥rica)
\[
\sum_{t^{'}\in T_{o,pratico}}w_{t,t'}\geq at_{t}\qquad\forall o\in O^{2}\,\forall t\in T_{o,teorico}
\]
}


\subsubsection{Obrigar uma turma te√≥rica a s√≥ se associar com uma turma pr√°tica
da oferta-disciplina (s√≥ se $relacPraticas^{*}=1\times1$)
\[
\sum_{t^{'}\in T_{o,pratico}}w_{t,t'}=at_{t}\qquad\forall o\in O^{2}\,\forall t\in T_{o,teorico}
\]
}


\subsubsection{Impedir a aloca√ß√£o de salas a turmas incompativeis
\[
\sum_{t\in TI}r_{t,s}\leq1\qquad\forall s\in S\,\forall TI\in CTI_{s}
\]
}


\subsubsection{Impor um m√≠nimo na produtividade do cr√©dito
\[
\sum_{a\in A}\sum_{o\in O_{a}}x_{a,o}\geq minRecCred^{*}\cdot\sum_{t\in T}at_{t}\cdot creds\left(t\right)
\]
}


\subsubsection{Obrigar um conjunto de turmas pr√©-definido a ser aberto (casos especiais)
\[
\sum_{t\in TA}at_{t}=\left|TA\right|
\]
}


\paragraph{P√≥s-processamento}
\begin{itemize}
\item \emph{tryReduzirSalas }: Este m√©todo tenta trocar as salas das turmas
de forma a maximizar a ocupa√ß√£o das salas, e libertar salas maior.
As trocas s√≥ s√£o permitidas em turmas da mesma unidade.
\end{itemize}

\paragraph*{C√≥digo}

A implementa√ß√£o do \emph{MIP Realocar Alunos} encontra-se na classe
\emph{MIPAlocarAlunos}, que herda a classe \emph{MIPAloc}. Ambas est√£o
definidas nos arquivos \emph{'MIPAlocarAlunos.h'},\emph{ 'MIPAlocarAlunos.cpp',
'MIPAloc.h' }e\emph{ 'MIPAloc.cpp'} do projeto.


\section{MIP Alocar Professores\label{sec:MIP-Alocar-Professores}}

Nesta sec√ß√£o ser√° apresentado o MIP por tr√°s da fun√ß√£o \emph{realocarProfsMIP
}introduzida na sec√ß√£o \ref{sub:Develop-Solu=0000E7=0000E3o}, onde
tamb√©m foram apresentados os seus par√¢metros e devido impacto.


\paragraph*{Objectivo}

Realocar os professores √†s turmas tentando minimizar o n√∫mero de turmas
com professor virtual e o n√∫mero de professores virtuais individualizados
necess√°rios, assim como a sua respetiva titula√ß√£o e tipo de contrato.


\paragraph*{Pr√©-processamento}
\begin{itemize}
\item \emph{criarProfsVirtuaisIndividualizados }: caso o par√¢metro \emph{profsVirtuaisIndiv}
estiver ativo, este m√©todo √© chamado. Cria c√≥pias de professores virtuais
individualizados com base em perfis. O n√∫mero de professores criados
para cada perfil √© estimado com base nas turmas que nesse momento
est√£o alocadas a professores virtuais. 
\end{itemize}

\subsection{Nota√ß√£o}


\subsubsection{Conjuntos}
\begin{itemize}
\item \emph{P} - conjunto de professores, excluindo o professor virtual
√∫nico. Os elementos desse conjunto s√£o denotados por \emph{p}.
\item \emph{D} - conjunto de dias da semana. Os elementos desse conjunto
s√£o denotados por \emph{d}.
\item \emph{T} - conjunto de turmas. Os elementos desse conjunto s√£o denotados
por \emph{t}.
\item \emph{C} - conjunto de cursos. Os elementos desse conjunto sao denotados
por \emph{c}.
\item \emph{E} - conjunto de titula√ß√µes. Os elementos desse conjunto s√£o
denotados de \emph{e}.
\item \emph{B} - conjunto de tipos de contrato. Os elementos desse conjunto
s√£o denotados por \emph{b}.
\item \emph{Q} - conjunto de perfis de professores virtuais. Os elementos
desse conjunto s√£o denotados por \emph{q}.
\item $P_{t}$ - conjunto de professores habilitados e dispon√≠veis para
leccionar uma turma \emph{t}, incluindo o professor virtual √∫nico.
Os elementos desse conjunto s√£o denotados por \emph{p}.
\item $P_{t,e}$ - conjunto de professores habilitados e dispon√≠veis para
leccionar uma turma \emph{t}, com titula√ß√£o igual ou superior a \emph{e}.
Inclui o professor virtual √∫nico. Os elementos desse conjunto s√£o
denotados por \emph{p}.
\item $P_{t,b}$ - conjunto de professores habilitados e dispon√≠veis para
leccionar uma turma \emph{t}, com tipo de contrato igual ou superior
a \emph{b}. Inclui o professor virtual √∫nico. Os elementos desse conjunto
s√£o denotados por \emph{p}.
\item $PV_{c,q}$ - conjunto de professores virtuais individualizados com
um perfil \emph{q}, associados a um curso \emph{c}. Os elementos desse
conjunto s√£o denotados por \emph{p}.
\item $T_{p}$ - conjunto de turmas para as quais um professor \emph{p}
est√° habilitado e dispon√≠vel. Os elementos desse conjunto s√£o denotados
por \emph{t}.
\item $T_{p,d}$ - conjunto de turmas que tem aulas num dia \emph{d} e que
podem ser leccionadas por um professor \emph{p}. Os elementos desse
conjunto s√£o denotados por \emph{t}.
\item $CTI_{p}$ - conjunto de conjuntos turmas que um professor \emph{p}
pode leccionar e que s√£o todas incompat√≠veis entre si. Os elementos
desse conjunto s√£o denotados por \emph{TI}.
\item $H_{f}$ - conjunto de hor·rios que cujo tempo de inÌcio pertencem ‡ fase do dia $f$.
\end{itemize}

\subsubsection{Dados do Modelo}
\begin{itemize}
\item $creds\left(t,d\right)$ - n√∫mero de creditos que uma turma \emph{t}
tem no dia \emph{d}.
\item $maxDias\left(p\right)$ - m√°ximo de dias a que um professor \emph{p}
pode ser alocado.
\item $maxCreds\left(p\right)$- m√°ximo de cr√©ditos a que um professor \emph{p}
pode ser alocado.
\item $minCreds\left(p\right)$ - m√≠nimo de cr√©ditos a que um professor
\emph{p} tem que ser alocado.
\item $minCredsDia\left(p\right)$ - m√≠nimo de cr√©ditos a que um professor
\emph{p} tem que ser alocado por dia.
\item $chAnt\left(p\right)$ - carga hor√°ria do semestre anterior anterior
do professor \emph{p} multiplicada por $percChAnt^{*}$.
\item $minTit\left(c,e\right)$ - percentagem m√≠nima de professores com
titula√ß√£o \emph{e} no curso \emph{c}.
\item $minCon\left(c,b\right)$ - percentagem m√≠nima de professores com
tipo de contrato \emph{b} no curso \emph{c}.
\item $\alpha\left(p,t\right)$ - peso da vari√°vel $x_{p,t}$ na fun√ß√£o
objectivo.
\item $\beta\left(p\right)$ - peso da vari√°vel $y_{p}$ na fun√ß√£o objectivo.
\item $\gamma\left(p\right)$ - peso da vari√°vel $v_{p}$ na fun√ß√£o objectivo.
\item $\delta\left(p,d\right)$ - peso da vari√°vel $w_{p,d}$ na fun√ß√£o
objectivo.
\item $\theta\left(p\right)$ - peso da vari√°vel $u_{p}$ na fun√ß√£o objectivo.
\item $m(dt)$	- n˙mero de minutos correspondentes ‡ hora e minuto do datetime dt. Por ex: $m(7:30) = 7\cdot60 + 30$.
\item $duracao_{x}$ - duraÁ„o (em minutos) da aula representada por x.
\item $delta_{f,t}$ - m·ximo de tempo ocioso permitido entre a primeira e a ˙ltima aula do professor na fase $f$ do dia $t$. Conta, basicamente, o tempo m·ximo possÌvel de intervalo entre aulas.
\end{itemize}

\subsubsection{Vari√°veis}
\begin{itemize}
\item $x_{p,t}$ - vari√°vel bin√°ria indicando que o professor\emph{ p} foi
alocado √† turma \emph{t}.
\item $y_{p}$ - vari√°vel bin√°ria indicando se o professor \emph{p} foi
alocado a alguma turma. 
\item $v_{p}$ - vari√°vel inteira maior ou igual a zero que indica o n√∫mero
de cr√©ditos que faltaram ao professor \emph{p} √© para ser alocado
a $minCreds\left(p\right)$ .
\item $w_{p,d}$ - vari√°vel bin√°ria que indica se o professor \emph{p} foi
alocado a alguma turma com aulas no dia \emph{d}.
\item $u_{p}$ - vari√°vel inteira maior ou igual a zero o que indica n√∫mero
de cr√©ditos que faltaram ao professor \emph{p} √© para ser alocado
a $chAnt\left(p\right)$ .
\item $hip_{p,t,f}$ - vari·vel inteira que indica em minutos o hor·rio de inÌcio da primeira aula alocada ao professor $p$ na fase do dia $f$. Por exemplo, se a primeira aula da fase $manh„$ alocada ao professor se inicia ‡s $09:30$, ent„o $hip = 9 \cdot 60 + 30 = 570$.
\item $hfp_{p,t,f}$ - vari·vel inteira que indica em minutos o hor·rio de fim da ˙ltima aula alocada ao professor $p$ na fase do dia $f$. Por exemplo, se a ˙ltima aula da fase $manh„$ alocada ao professor termina ‡s $11:30$, ent„o $hip = 11 \cdot 60 + 30 = 690$.
\end{itemize}

\subsection{Formula√ß√£o}


\subsubsection{Fun√ß√£o Objectivo
\[
MAX\:\sum_{p\in P}\left(\beta\left(p\right)\cdot y_{p}+\gamma\left(p\right)\cdot v_{p}+\theta\left(p\right)\cdot u_{p}+\sum_{t\in T_{p}}\alpha\left(p,t\right)\cdot x_{p,t}+\sum_{d\in D}\delta\left(p,d\right)\cdot w_{p,d}\right)
\]
}


\subsubsection{Alocar um professor para cada turma
\[
\sum_{p\in P_{t}}x_{p,t}=1\qquad\forall t\in T
\]
}


\subsubsection{Usar professor
\[
\sum_{t\in T_{p}}x_{p,t}\leq y_{p}\cdot\left|T_{p}\right|\qquad\forall p\in P
\]
}


\subsubsection{Impedir que um professor seja alocado a turmas incompat√≠veis
\[
\sum_{t\in TI}x_{p,t}\leq1\qquad\forall p\in P\:\forall TI\in CTI_{p}
\]
}


\subsubsection{Identificar quando o professor √© alocado num dia da semana
\[
\sum_{t\in T_{p,d}}x_{p,t}\leq\left|T_{p,d}\right|\cdot w_{p,d}\qquad\forall p\in P\,\forall d\in D
\]
}


\subsubsection{Obrigar o professor a ser alocado a um m√≠nimo de cr√©ditos por dia
\[
\sum_{t\in T_{p,d}}x_{p,t}\cdot creds\left(t\right)\geq minCredsDia\left(p\right)\cdot w_{p,d}\qquad\forall p\in P\,\forall d\in D
\]
}


\subsubsection{M√°ximo dias semana do professor
\[
\sum_{d\in D}w_{p,d}\leq maxDias\left(p\right)\qquad\forall p\in P
\]
}


\subsubsection{M√°ximo de cr√©ditos a que um professor pode ser alocado
\[
\sum_{t\in T_{p}}x_{p,t}\cdot creds\left(t\right)\leq maxCreds\left(p\right)\qquad\forall p\in P
\]
}


\subsubsection{M√≠nimo de cr√©ditos de um professor (se $minChForte^{*}$ ligado)
\[
\sum_{t\in T_{p}}x_{p,t}\geq minCreds\left(p\right)\cdot y_{p}\qquad\forall p\in P
\]
}


\subsubsection{M√≠nimo de cr√©ditos de um professor (se $minChForte^{*}$ desligado)
\[
\sum_{t\in T_{p}}x_{p,t}+v_{p}\geq minCreds\left(p\right)\qquad\forall p\in P
\]
}


\subsubsection{Verificar se o professor √© alocado √† percentagem da carga hor√°ria
anterior que √© pretendida
\[
\sum_{t\in T_{p}}x_{p,t}+u_{p}\geq chAnt\left(p\right)\qquad\forall p\in P
\]
}


\subsubsection{R√°cio m√≠nimo de professores com uma titula√ß√£o alocados a turmas com
alunos de um curso}

\[
\sum_{t\in T_{c}}\sum_{p\in P_{t,e}}x_{p,t}\geq\sum_{t\in T_{c}}\sum_{p\in P_{t}}x_{p,t}\cdot minTit\left(c,e\right)\qquad\forall c\in C\,\forall e\in E
\]



\subsubsection{R√°cio m√≠nimo de professores com um tipo de contrato alocados a turmas
com alunos de um curso}

\[
\sum_{t\in T_{c}}\sum_{p\in P_{t,b}}x_{p,t}\geq\sum_{t\in T_{c}}\sum_{p\in P_{t}}x_{p,t}\cdot minCon\left(c,b\right)\qquad\forall c\in C\,\forall b\in B
\]



\subsubsection{Uso sequencial de professores virtuais individualizados associados
ao mesmo curso, com o mesmo perfil (caso $profsVirtuaisIndiv$)
\[
y_{PV_{c,q}[i+1]}\leq y_{PV_{c,q}[i]}\qquad\forall c\in C\,\forall q\in Q\,\forall i\in\left\{ 0,1,\ldots,\left|PV_{c,q}\right|-1\right\} 
\]
}



\subsubsection{Set the lower bound para a vari·vel hip_{p,t,f}}

\[
hip_{p,t,f} \geq m(dt) \cdot ( 1 - \sum_{x \in X_{dti<dt}} x_{p,t,dti} ) \qquad\forall p \in P\,\forall t \in T\,\forall f \in F\,\forall dt \in Dt
\]



\subsubsection{Set the upper bound para a vari·vel hip_{p,t,f}}

\[
hip_{p,t,f} \leq m(dt) + M \cdot ( 1 - \sum_{x \in X_{dti=dt}} x_{p,t,h} ) \qquad\forall p \in P\,\forall t \in T\,\forall f \in F\,\forall dt \in Dt
\]



\subsubsection{Set the lower bound para a vari·vel hfp_{p,t,f}}

\[
hfp_{p,t,f} \geq \sum_{x \in X_{dtf=dt}} m(dt) \cdot x_{p,t,h} \qquad\forall p \in P\,\forall t \in T\,\forall f \in F\,\forall dt \in Dt
\]



\subsubsection{Set the upper bound para a vari·vel hfp_{p,t,f}}

\[
hfp_{p,t,f} \leq m(dt) + M \cdot ( \sum_{x \in X_{dtf>dt}} x_{p,t,h} ) \qquad\forall p \in P\,\forall t \in T\,\forall f \in F\,\forall dt \in Dt
\]




\subsubsection{ProÌbe gap no hor·rio do professor em uma mesma fase do dia}

\[
\sum_{x \in X_{h \in H_{f}}} tempo_{x} \cdot x_{p,t,h} + delta_{f,t} \geq hfp_{p,t,f} - hip_{p,t,f} \qquad\forall p \in P\,\forall t \in T\,\forall f \in F
\]




\paragraph*{C√≥digo}

A implementa√ß√£o do \emph{MIP Alocar Professores} encontra-se na classe
\emph{MIPAlocProfs}, que herda a classe \emph{MIPAloc}. Ambas est√£o
definidas nos arquivos \emph{'MIPAlocProfs.h'},\emph{ 'MIPAlocProfs.cpp',
'MIPAloc.h' }e\emph{ 'MIPAloc.cpp'} do projeto.

\end{document}
